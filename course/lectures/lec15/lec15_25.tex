%!TEX root = lec15.tex
% ================================================================================
% Lecture 15 â€” Slide 25
% ================================================================================
\begin{frame}[t,fragile]
\mytitle{Inference Pipeline: Load Checkpoint $\rightarrow$ Predict $\rightarrow$ Plot}

\begin{columns}[T,totalwidth=\textwidth]

% ------------------------------------------------------------
\begin{column}[T]{0.58\textwidth}
\footnotesize
\vspace{-2mm}

\textbf{What happens after training?}

\vspace{0mm}
\begin{itemize}
  \item load \y{checkpoint} (\texttt{inference-last.ckpt})
  \item load forecast data from \y{zarr archive}
  \item build input tensor (multi-step input supported)
  \item run \texttt{model.predict\_step(...)}
\end{itemize}

\vspace{0mm}
\textbf{Outputs}

\vspace{0mm}
\begin{itemize}
  \item predicted CBCF fields / masks
  \item comparison against targets
  \item saved plots per date + variable
\end{itemize}

\vspace{0mm}
\textbf{Take-away}

\vspace{0mm}
\begin{itemize}
  \item same pipeline works for long archives
  \item basis for \y{operational verification and monitoring}
\end{itemize}

\end{column}

% ------------------------------------------------------------
\begin{column}[T]{0.42\textwidth}
\vspace{-2mm}
\footnotesize

\textbf{Code sketch (from \texttt{main.py})}
\begin{lstlisting}[basicstyle=\ttfamily\scriptsize]
model = torch.load(ckpt)
model.eval()

ds = zarr.open("...CBCF.zarr")

input = build_tensor(...)
y_pred = model.predict_step(input)

plot(y_pred); plot(target)
\end{lstlisting}

\vspace{1mm}
\scriptsize
The demo uses multi-step inputs and produces predicted/target plots.

\end{column}

\end{columns}
\end{frame}
