%!TEX root = lec02.tex
% ================================================================================
% Slide
% ================================================================================
\begin{frame}[t,fragile]

\mytitle{Calling Fortran from Python with \texttt{ctypes}}

\begin{columns}[T,totalwidth=\textwidth]

% --- Left column ---------------------------------------------------------------
\begin{column}[T]{0.32\textwidth}

\vspace{-1mm}
\textbf{Role of Python}

\begin{itemize}
  \item Python loads the shared library
  \item Defines the \y{function signature}
  \item Manages data exchange
\end{itemize}

\vspace{1mm}
\textbf{Important Detail}

\begin{itemize}
  \item Fortran arguments are passed \y{by reference}
  \item Python must pass pointers
\end{itemize}

\end{column}

% --- Right column --------------------------------------------------------------
\begin{column}[T]{0.68\textwidth}

\vspace{-3mm}
\begin{codeonly}{Minimal Python Interface}
import ctypes

lib = ctypes.CDLL("./fortran_interface.so")
lib.f_sin_cos.argtypes = [
    ctypes.POINTER(ctypes.c_double) ]
lib.f_sin_cos.restype = ctypes.c_double

x = ctypes.c_double(1.0)
y = lib.f_sin_cos(ctypes.byref(x))
\end{codeonly}

\vspace{-1mm}
\begin{itemize}
  \item Native Fortran computation
  \item Controlled Python interface
  \item No performance-critical Python loop
\end{itemize}

\end{column}

% --- End Columns --------------------------------------------------------------
\end{columns}
\end{frame}
